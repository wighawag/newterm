const { spawn } = require('child_process');
const commandExistsSync = require('command-exists').sync;

module.exports = function(command, commandArguments, spawnOptions) {
  const terminal = spawnOptions.terminal || ['gnome-terminal', 'konsole', 'xterm', 'io.elementary.terminal'].find(commandExistsSync);

  const commandToRun = 
    [command]
    .concat(commandArguments.map(arg => arg.replace(/"/g, '\\"')))
    .join(' ');
  
  return spawn(terminal, ['-e'].concat([`"${commandToRun}"`]), {
    shell: true,
    stdio: 'ignore',
    cwd: spawnOptions.cwd
  });
}
